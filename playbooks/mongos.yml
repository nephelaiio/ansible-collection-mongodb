---
- name: Gather cluster host facts
  hosts: "{{ mongodb | default('mongodb') }}"


- name: Deploy mongodb mongos servers
  hosts: "{{ mongodb_mongos | default('mongodb_mongos') }}"
  become: true
  roles:
    - mongos
  vars:
    mongos_replicaset_config_members: "{{ groups['mongodb_config'] | map('extract', hostvars, ['ansible_default_ipv4', 'address']) }}"
